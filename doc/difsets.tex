% generated by GAPDoc2LaTeX from XML source (Frank Luebeck)
\documentclass[a4paper,11pt]{report}

\usepackage{a4wide}
\sloppy
\pagestyle{myheadings}
\usepackage{amssymb}
\usepackage[latin1]{inputenc}
\usepackage{makeidx}
\makeindex
\usepackage{color}
\definecolor{FireBrick}{rgb}{0.5812,0.0074,0.0083}
\definecolor{RoyalBlue}{rgb}{0.0236,0.0894,0.6179}
\definecolor{RoyalGreen}{rgb}{0.0236,0.6179,0.0894}
\definecolor{RoyalRed}{rgb}{0.6179,0.0236,0.0894}
\definecolor{LightBlue}{rgb}{0.8544,0.9511,1.0000}
\definecolor{Black}{rgb}{0.0,0.0,0.0}

\definecolor{linkColor}{rgb}{0.0,0.0,0.554}
\definecolor{citeColor}{rgb}{0.0,0.0,0.554}
\definecolor{fileColor}{rgb}{0.0,0.0,0.554}
\definecolor{urlColor}{rgb}{0.0,0.0,0.554}
\definecolor{promptColor}{rgb}{0.0,0.0,0.589}
\definecolor{brkpromptColor}{rgb}{0.589,0.0,0.0}
\definecolor{gapinputColor}{rgb}{0.589,0.0,0.0}
\definecolor{gapoutputColor}{rgb}{0.0,0.0,0.0}

%%  for a long time these were red and blue by default,
%%  now black, but keep variables to overwrite
\definecolor{FuncColor}{rgb}{0.0,0.0,0.0}
%% strange name because of pdflatex bug:
\definecolor{Chapter }{rgb}{0.0,0.0,0.0}
\definecolor{DarkOlive}{rgb}{0.1047,0.2412,0.0064}


\usepackage{fancyvrb}

\usepackage{mathptmx,helvet}
\usepackage[T1]{fontenc}
\usepackage{textcomp}


\usepackage[
            pdftex=true,
            bookmarks=true,        
            a4paper=true,
            pdftitle={Written with GAPDoc},
            pdfcreator={LaTeX with hyperref package / GAPDoc},
            colorlinks=true,
            backref=page,
            breaklinks=true,
            linkcolor=linkColor,
            citecolor=citeColor,
            filecolor=fileColor,
            urlcolor=urlColor,
            pdfpagemode={UseNone}, 
           ]{hyperref}

\newcommand{\maintitlesize}{\fontsize{50}{55}\selectfont}

% write page numbers to a .pnr log file for online help
\newwrite\pagenrlog
\immediate\openout\pagenrlog =\jobname.pnr
\immediate\write\pagenrlog{PAGENRS := [}
\newcommand{\logpage}[1]{\protect\write\pagenrlog{#1, \thepage,}}
%% were never documented, give conflicts with some additional packages

\newcommand{\GAP}{\textsf{GAP}}

%% nicer description environments, allows long labels
\usepackage{enumitem}
\setdescription{style=nextline}

%% depth of toc
\setcounter{tocdepth}{1}





%% command for ColorPrompt style examples
\newcommand{\gapprompt}[1]{\color{promptColor}{\bfseries #1}}
\newcommand{\gapbrkprompt}[1]{\color{brkpromptColor}{\bfseries #1}}
\newcommand{\gapinput}[1]{\color{gapinputColor}{#1}}


\begin{document}

\logpage{[ 0, 0, 0 ]}
\begin{titlepage}
\mbox{}\vfill

\begin{center}{\maintitlesize \textbf{The \textsf{DifSets} Package\mbox{}}}\\
\vfill

\hypersetup{pdftitle=The \textsf{DifSets} Package}
\markright{\scriptsize \mbox{}\hfill The \textsf{DifSets} Package \hfill\mbox{}}
{\Huge Version 2.1.0\mbox{}}\\[1cm]
{23 December 2017\mbox{}}\\[1cm]
\mbox{}\\[2cm]
{\Large \textbf{ Dylan Peifer \\
    \mbox{}}}\\
\hypersetup{pdfauthor= Dylan Peifer \\
    }
\end{center}\vfill

\mbox{}\\
{\mbox{}\\
\small \noindent \textbf{ Dylan Peifer \\
    }  Email: \href{mailto://djp282@cornell.edu} {\texttt{djp282@cornell.edu}}\\
  Homepage: \href{http://www.math.cornell.edu/~djp282} {\texttt{http://www.math.cornell.edu/\texttt{\symbol{126}}djp282}}\\
  Address: \begin{minipage}[t]{8cm}\noindent
 Department of Mathematics \\
 105 Malott Hall \\
 Cornell University \\
 Ithaca, NY 14853-4201 USA \end{minipage}
}\\
\end{titlepage}

\newpage\setcounter{page}{2}
{\small 
\section*{Abstract}
\logpage{[ 0, 0, 1 ]}
 The \textsf{DifSets} Package implements an algorithm for enumerating all difference sets up to
equivalence in an arbitrary finite group. The algorithm functions by finding
difference sums, which are potential images of difference sets in quotient
groups of the original group, and searching their preimages. In this way, the
search space can be dramatically decreased, and searches of groups of
relatively large order (such as order 64 or order 96) can be completed. \mbox{}}\\[1cm]
{\small 
\section*{Copyright}
\logpage{[ 0, 0, 2 ]}
 Copyright {\copyright} 2017 Dylan Peifer 

 This program is free software: you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation, either version 3 of the License, or (at your option) any later
version. 

 This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. 

 You should have received a copy of the GNU General Public License along with
this program. If not, see \href{http://www.gnu.org/licenses/} {\texttt{http://www.gnu.org/licenses/}}. \mbox{}}\\[1cm]
\newpage

\def\contentsname{Contents\logpage{[ 0, 0, 3 ]}}

\tableofcontents
\newpage

 
\chapter{\textcolor{Chapter }{Definitions}}\logpage{[ 1, 0, 0 ]}
\hyperdef{L}{X84541F61810C741D}{}
{
  
\section{\textcolor{Chapter }{Difference Sets}}\logpage{[ 1, 1, 0 ]}
\hyperdef{L}{X8248A9AB7E689C64}{}
{
  A $\langle v, k, \lambda \rangle$-difference set is a nonempty proper subset $D$ of a finite group $G$ such that $|G| = v$, $|D| = k$, and each nonidentity element of $G$ can be written as $d_id_j^{-1}$ for $d_i, d_j \in D$ in exactly $\lambda$ different ways. The standard example is the $\langle 7, 3, 1\rangle$-difference set $\{1, 2, 4\}$ of the group $\mathbb{Z}/7\mathbb{Z}$ under addition. Additionally, it can easily be shown that every one element
subset of a group is a difference set, and the complement of any difference
set is also a difference set. 

 We will often abuse notation and let $D$ denote both the set $D$ and the element 
\[D = \sum_{d \in D} d\]
 of the group ring $\mathbb{Z}[G]$. Then define 
\[gD = \sum_{d \in D} gd,\]
\[D^\phi = \sum_{d \in D} \phi(d),\]
\[D^{(-1)} = \sum_{d \in D} d^{-1},\]
 where $g \in G$ and $\phi$ is a homomorphism with domain $G$. Using this notation, a difference set in $G$ is an element of the group ring $\mathbb{Z}[G]$ with coefficients from $\{0, 1\}$ such that $DD^{(-1)} = (k-\lambda) + \lambda G$, where by convention the isolated coefficients $(k-\lambda)$ are assumed to be coefficients of the identity. 

 Two difference sets $D_1, D_2$ are equivalent if both are in the same group $G$ and $D_1 = gD_2^\phi$ for some $g \in G$ and $\phi \in \mathrm{Aut}(G)$. In other words, $D_1$ is equivalent to $D_2$ if $D_1$ can be mapped to $D_2$ by translation and automorphism in the group $G$. We say $D_1, D_2$ are translationally equivalent if they are equivalent solely by translation,
meaning $D_1 = gD_2$ for some $g \in G$. 

 In the package, difference sets are stored as lists of integers that represent
the index of the elements in the difference set as found in the list of all
elements in the group returned by the \textsf{GAP} function \texttt{Elements(G)}. For example, the difference set \texttt{[1, 3, 6, 9, 11, 13]} in \texttt{SmallGroup(16, 5)} really consists of the first, third, sixth, ninth, eleventh, and thirteenth
elements of the list returned by \texttt{Elements(SmallGroup(16, 5))}. When given as arguments, difference sets in the package are never assumed to
be sorted, but many functions will return difference sets in sorted order
since sorting is used internally. }

 
\section{\textcolor{Chapter }{Difference Sums}}\logpage{[ 1, 2, 0 ]}
\hyperdef{L}{X7A3AC90D79A6AA3B}{}
{
  A $\langle v, k, \lambda \rangle$-difference sum in a group $G$ modulo its normal subgroup $N$ is an element $S$ of the group ring $\mathbb{Z}[G/N]$ such that $SS^{(-1)} = (k - \lambda) + \lambda |N|G/N$ and the coefficients of $S$ have values in $\{0, 1, \dots, |N|\}$. Note that the original $G$ and $N$ are included in the definition, so it makes no sense to talk about a
difference sum in some arbitrary group $H$. The size of a difference sum is the sum of its coefficients, and by defining
the complement of $S$ to be $|N|G/N - S$ we can see that, similar to difference sets, size one sums and complements of
difference sums are always difference sums. 

 Two difference sums $S_1, S_2$ are equivalent if both are in the same group $G$ mod its normal subgroup $N$ and $S_1 = gS_2^\phi$ for some $g \in G/N$ and $\phi$ an automorphism of $G/N$ induced by an automorphism of $G$. Note that not all automorphisms of $G/N$ are induced by automorphisms of $G$, so our definition here is more restrictive than perhaps expected. As with
difference sets, the sums $S_1, S_2$ are translationally equivalent if $S_1 = gS_2$ for some $g \in G/N$. 

 In the package, difference sums are stored as lists of integers that represent
the values of the coefficients of the group ring elements, with position in
the list given by the position of the coset in the list of elements returned
by the \textsf{GAP} function \texttt{Elements(G/N)}. For example, the difference sum \texttt{[2, 4]} in \texttt{SmallGroup(16, 5)} mod its normal subgroup \texttt{NormalSubgroups(SmallGroup(16, 5))[2]} has coefficient 2 on the identity coset, and coefficient 4 on the nonidentity
coset. 

 Difference sums can be thought of as a generalization of difference sets. More
importantly, however, difference sums can be thought of as images of
difference sets in quotients of the original group. In particular, if $\theta : G \to G/N$ is the natural projection, then for any difference set $D$ in $\mathbb{Z}[G]$ we have a difference sum $D^\theta$ in $G$ modulo its normal subgroup $N$. Additionally, difference sums induce other difference sums in any further
quotient. The fundamental idea of the algorithm in this package is that we can
reverse this process. Starting with $G$ mod $G$, where the only difference sum of size $k$ is \texttt{[k]}, we can successively refine this difference sum up a series of quotients of $G$ until reaching $G$ itself. In each step we enumerate all preimages of the difference sums and
remove preimages that are not difference sums themselves. In the final step we
refine to difference sets. Furthermore, since equivalent difference sums will
have equivalent collections of difference sets as preimages, in each step we
remove all but one representative of each equivalence class from our
collection. This method dramatically decreases the search space for an
exhaustive enumeration of all difference sets up to equivalence in $G$. }

 }

 
\chapter{\textcolor{Chapter }{Package Contents}}\logpage{[ 2, 0, 0 ]}
\hyperdef{L}{X7F5ED06E833C164E}{}
{
  The \textsf{DifSets} Package consists of a collection of functions implementing the main algorithm,
and some additional functions for experimentation and testing. Several
functions not appearing in this documentation are used internally for certain
subtasks. See the code itself for details. 
\section{\textcolor{Chapter }{The Main Functions}}\logpage{[ 2, 1, 0 ]}
\hyperdef{L}{X7D3DC4ED855DC13C}{}
{
  The purpose of this package is to provide a function that efficiently
enumerates all difference sets up to equivalence in a given group. Similarly,
we can also enumerate all difference sums up to equivalence. The following are
these functions. Their components are described in further sections. 

\subsection{\textcolor{Chapter }{DifferenceSets}}
\logpage{[ 2, 1, 1 ]}\nobreak
\hyperdef{L}{X83297D2B85F9E074}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{DifferenceSets({\mdseries\slshape G})\index{DifferenceSets@\texttt{DifferenceSets}}
\label{DifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns a list of all difference sets up to equivalence in the group \mbox{\texttt{\mdseries\slshape G}}. Only the smaller of each complementary pair of difference sets is included,
and one-element difference sets are ignored. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 9);;|
  !gapprompt@gap>| !gapinput@DifferenceSets(G);|
  [ [ 1, 2, 8, 10, 11, 15 ], [ 1, 2, 8, 9, 10, 11 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{DifferenceSums}}
\logpage{[ 2, 1, 2 ]}\nobreak
\hyperdef{L}{X7B5B1D8D86014468}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{DifferenceSums({\mdseries\slshape G, N})\index{DifferenceSums@\texttt{DifferenceSums}}
\label{DifferenceSums}
}\hfill{\scriptsize (function)}}\\


 Returns a list of all difference sums up to equivalence in the group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}}. Only the smaller of each complementary pair of difference sums is included,
and difference sums of size 1 are ignored. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 8);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@DifferenceSums(G, N);|
  [ [ 3, 1, 1, 1 ], [ 2, 2, 2, 0 ] ]
\end{Verbatim}
 }

 }

 
\section{\textcolor{Chapter }{Sizes}}\logpage{[ 2, 2, 0 ]}
\hyperdef{L}{X80CEEB697EA8D462}{}
{
  The first step of the algorithm is to determine what possible sizes of
difference sets and sums the group can contain. Each size is then handled
individually since different size sets or sums will never be equivalent. 

\subsection{\textcolor{Chapter }{PossibleDifferenceSetSizes}}
\logpage{[ 2, 2, 1 ]}\nobreak
\hyperdef{L}{X7DEB0B3B7E1FFF0B}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{PossibleDifferenceSetSizes({\mdseries\slshape G})\index{PossibleDifferenceSetSizes@\texttt{PossibleDifferenceSetSizes}}
\label{PossibleDifferenceSetSizes}
}\hfill{\scriptsize (function)}}\\


 Returns a list of the possible sizes of difference sets in group \mbox{\texttt{\mdseries\slshape G}}. Only the smaller of any pair of complementary sizes is returned, and the
trivial size 1 is never included. Current implementation simply returns all
values of k such that lambda = k(k-1)/(v-1) is an integer, where v is the
order of \mbox{\texttt{\mdseries\slshape G}}, and the resulting parameters v, k, lambda pass the Bruck-Ryser-Chowla test. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(31, 1);;|
  !gapprompt@gap>| !gapinput@PossibleDifferenceSetSizes(G);|
  [ 6, 10, 15 ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{DifferenceSetsOfSizeK}}
\logpage{[ 2, 2, 2 ]}\nobreak
\hyperdef{L}{X7E7D360080D99FE7}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{DifferenceSetsOfSizeK({\mdseries\slshape G, k})\index{DifferenceSetsOfSizeK@\texttt{DifferenceSetsOfSizeK}}
\label{DifferenceSetsOfSizeK}
}\hfill{\scriptsize (function)}}\\


 Returns a list of all difference sets up to equivalence in the group \mbox{\texttt{\mdseries\slshape G}} that have size \mbox{\texttt{\mdseries\slshape k}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 9);;|
  !gapprompt@gap>| !gapinput@DifferenceSetsOfSizeK(G, 1);|
  [ [ 1 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{DifferenceSumsOfSizeK}}
\logpage{[ 2, 2, 3 ]}\nobreak
\hyperdef{L}{X7C01E15C83213BFB}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{DifferenceSumsOfSizeK({\mdseries\slshape G, N, k})\index{DifferenceSumsOfSizeK@\texttt{DifferenceSumsOfSizeK}}
\label{DifferenceSumsOfSizeK}
}\hfill{\scriptsize (function)}}\\


 Returns a list of all difference sums up to equivalence in the group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}} that have size \mbox{\texttt{\mdseries\slshape k}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 8);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@DifferenceSumsOfSizeK(G, N, 1);|
  [ [ 1, 0, 0, 0 ] ]
\end{Verbatim}
 }

 }

 
\section{\textcolor{Chapter }{Refining}}\logpage{[ 2, 3, 0 ]}
\hyperdef{L}{X8735819681ED05EB}{}
{
  Refining refers to the process of enumerating the preimages of a difference
sum and filtering out preimages that are not themselves difference sets or
sums. For each size $k$ we know that the only difference sum of size $k$ in $G$ mod $G$ is \texttt{[k]}. Starting with this difference sum, we successivly refine through a series of
quotients of $G$ to eventually reach the desired sums or sets. In the algorithm, we use \texttt{SomeRefinedDifferenceSets} (\ref{SomeRefinedDifferenceSets}) and \texttt{SomeRefinedDifferenceSums} (\ref{SomeRefinedDifferenceSums}) rather than \texttt{AllRefinedDifferenceSets} (\ref{AllRefinedDifferenceSets}) and \texttt{AllRefinedDifferenceSums} (\ref{AllRefinedDifferenceSums}) since the former are faster and we only need at least one representative of
each equivalence class since additional equivalent sums or sets will just be
removed anyway. 

\subsection{\textcolor{Chapter }{RefiningSeries}}
\logpage{[ 2, 3, 1 ]}\nobreak
\hyperdef{L}{X85A8B29085DC0CEB}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{RefiningSeries({\mdseries\slshape G})\index{RefiningSeries@\texttt{RefiningSeries}}
\label{RefiningSeries}
}\hfill{\scriptsize (function)}}\\


 Returns a normal series for group \mbox{\texttt{\mdseries\slshape G}}. Current implementation produces a chief series through a nontrivial normal
subgroup of smallest possible size in \mbox{\texttt{\mdseries\slshape G}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(8, 3);;|
  !gapprompt@gap>| !gapinput@RefiningSeries(G);|
  [ <pc group of size 8 with 3 generators>, Group([ f2, f3 ]), Group([ f3 ]), 
    Group([  ]) ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{AllRefinedDifferenceSets}}
\logpage{[ 2, 3, 2 ]}\nobreak
\hyperdef{L}{X78CDE421817B50EE}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{AllRefinedDifferenceSets({\mdseries\slshape G, N, difsums})\index{AllRefinedDifferenceSets@\texttt{AllRefinedDifferenceSets}}
\label{AllRefinedDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns a list of all difference sets that are preimages of difference sums
contained in the list \mbox{\texttt{\mdseries\slshape difsums}} of difference sums in group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}}. Difference sums in \mbox{\texttt{\mdseries\slshape difsums}} are all assumed to be the same size. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@AllRefinedDifferenceSets(G, N, [[3,1,1,1], [2,2,2,0]]);|
  [ [ 1, 3, 2, 8, 4, 15 ], [ 1, 3, 2, 8, 9, 11 ], [ 1, 3, 2, 13, 4, 11 ], 
    [ 1, 3, 2, 13, 9, 15 ], [ 1, 3, 6, 8, 4, 11 ], [ 1, 3, 6, 8, 9, 15 ], 
    [ 1, 3, 6, 13, 4, 15 ], [ 1, 3, 6, 13, 9, 11 ], [ 1, 5, 2, 6, 4, 15 ], 
    [ 1, 5, 2, 6, 9, 11 ], [ 1, 5, 2, 13, 4, 9 ], [ 1, 5, 2, 13, 11, 15 ], 
    [ 1, 5, 6, 8, 4, 9 ], [ 1, 5, 6, 8, 11, 15 ], [ 1, 5, 8, 13, 4, 15 ], 
    [ 1, 5, 8, 13, 9, 11 ], [ 1, 10, 2, 6, 4, 11 ], [ 1, 10, 2, 6, 9, 15 ], 
    [ 1, 10, 2, 8, 4, 9 ], [ 1, 10, 2, 8, 11, 15 ], [ 1, 10, 6, 13, 4, 9 ], 
    [ 1, 10, 6, 13, 11, 15 ], [ 1, 10, 8, 13, 4, 11 ], [ 1, 10, 8, 13, 9, 15 ], 
    [ 3, 5, 2, 6, 4, 11 ], [ 3, 5, 2, 6, 9, 15 ], [ 3, 5, 2, 8, 4, 9 ], 
    [ 3, 5, 2, 8, 11, 15 ], [ 3, 5, 6, 13, 4, 9 ], [ 3, 5, 6, 13, 11, 15 ], 
    [ 3, 5, 8, 13, 4, 11 ], [ 3, 5, 8, 13, 9, 15 ], [ 3, 10, 2, 6, 4, 15 ], 
    [ 3, 10, 2, 6, 9, 11 ], [ 3, 10, 2, 13, 4, 9 ], [ 3, 10, 2, 13, 11, 15 ], 
    [ 3, 10, 6, 8, 4, 9 ], [ 3, 10, 6, 8, 11, 15 ], [ 3, 10, 8, 13, 4, 15 ], 
    [ 3, 10, 8, 13, 9, 11 ], [ 5, 10, 2, 8, 4, 15 ], [ 5, 10, 2, 8, 9, 11 ], 
    [ 5, 10, 2, 13, 4, 11 ], [ 5, 10, 2, 13, 9, 15 ], [ 5, 10, 6, 8, 4, 11 ], 
    [ 5, 10, 6, 8, 9, 15 ], [ 5, 10, 6, 13, 4, 15 ], [ 5, 10, 6, 13, 9, 11 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{NrAllRefinedSets}}
\logpage{[ 2, 3, 3 ]}\nobreak
\hyperdef{L}{X8527B7D687C04A1C}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{NrAllRefinedSets({\mdseries\slshape G, N, difsums})\index{NrAllRefinedSets@\texttt{NrAllRefinedSets}}
\label{NrAllRefinedSets}
}\hfill{\scriptsize (function)}}\\


 Returns the number of preimages that will need to be checked during a call to \texttt{AllRefinedDifferenceSets} (\ref{AllRefinedDifferenceSets}) with the same arguments. This can give a rough estimate of how long the call
will take to complete. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@NrAllRefinedSets(G, N, [[3,1,1,1], [2,2,2,0]]);|
  472
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{SomeRefinedDifferenceSets}}
\logpage{[ 2, 3, 4 ]}\nobreak
\hyperdef{L}{X7E1012C07FB328B4}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{SomeRefinedDifferenceSets({\mdseries\slshape G, N, difsums})\index{SomeRefinedDifferenceSets@\texttt{SomeRefinedDifferenceSets}}
\label{SomeRefinedDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns a list of some difference sets that are preimages of difference sums
contained in the list \mbox{\texttt{\mdseries\slshape difsums}} of difference sums in group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}}. At least one member of each equivalence class that would appear in the set
of all preimages will be returned, but all preimage difference sets may not
appear. Difference sums in \mbox{\texttt{\mdseries\slshape difsums}} are all assumed to be the same size. Current implementation forces the choice
of an identity element when possible. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@SomeRefinedDifferenceSets(G, N, [[3,1,1,1], [2,2,2,0]]);|
  [ [ 1, 3, 2, 8, 4, 15 ], [ 1, 3, 2, 8, 9, 11 ], [ 1, 3, 2, 13, 4, 11 ], 
    [ 1, 3, 2, 13, 9, 15 ], [ 1, 3, 6, 8, 4, 11 ], [ 1, 3, 6, 8, 9, 15 ], 
    [ 1, 3, 6, 13, 4, 15 ], [ 1, 3, 6, 13, 9, 11 ], [ 1, 5, 2, 6, 4, 15 ], 
    [ 1, 5, 2, 6, 9, 11 ], [ 1, 5, 2, 13, 4, 9 ], [ 1, 5, 2, 13, 11, 15 ], 
    [ 1, 5, 6, 8, 4, 9 ], [ 1, 5, 6, 8, 11, 15 ], [ 1, 5, 8, 13, 4, 15 ], 
    [ 1, 5, 8, 13, 9, 11 ], [ 1, 10, 2, 6, 4, 11 ], [ 1, 10, 2, 6, 9, 15 ], 
    [ 1, 10, 2, 8, 4, 9 ], [ 1, 10, 2, 8, 11, 15 ], [ 1, 10, 6, 13, 4, 9 ], 
    [ 1, 10, 6, 13, 11, 15 ], [ 1, 10, 8, 13, 4, 11 ], [ 1, 10, 8, 13, 9, 15 ] ] 
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{NrSomeRefinedSets}}
\logpage{[ 2, 3, 5 ]}\nobreak
\hyperdef{L}{X7ADBC8A6825A1FE4}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{NrSomeRefinedSets({\mdseries\slshape G, N, difsums})\index{NrSomeRefinedSets@\texttt{NrSomeRefinedSets}}
\label{NrSomeRefinedSets}
}\hfill{\scriptsize (function)}}\\


 Returns the number of preimages that will need to be checked during a call to \texttt{SomeRefinedDifferenceSets} (\ref{SomeRefinedDifferenceSets}) with the same arguments. This can give a rough estimate of how long the call
will take to complete. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@NrSomeRefinedSets(G, N, [[3,1,1,1], [2,2,2,0]]);|
  300
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{AllRefinedDifferenceSums}}
\logpage{[ 2, 3, 6 ]}\nobreak
\hyperdef{L}{X80BF8487824FA6B1}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{AllRefinedDifferenceSums({\mdseries\slshape G, N1, N2, difsums})\index{AllRefinedDifferenceSums@\texttt{AllRefinedDifferenceSums}}
\label{AllRefinedDifferenceSums}
}\hfill{\scriptsize (function)}}\\


 Returns a list of all difference sums in group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N2}} that are preimages of difference sums contained in the list \mbox{\texttt{\mdseries\slshape difsums}} of difference sums in group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N1}}. The subgroup \mbox{\texttt{\mdseries\slshape N2}} must be contained in \mbox{\texttt{\mdseries\slshape N1}}. Difference sums in \mbox{\texttt{\mdseries\slshape difsums}} are all assumed to be the same size. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N1 := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@N2 := NormalSubgroups(G)[8];;|
  !gapprompt@gap>| !gapinput@AllRefinedDifferenceSums(G, N1, N2, [[3,1,1,1], [2,2,2,0]]);|
  [ [ 1, 1, 0, 1, 0, 1, 2, 0 ], [ 1, 1, 2, 1, 0, 1, 0, 0 ], 
    [ 1, 0, 1, 1, 0, 2, 1, 0 ], [ 1, 2, 1, 1, 0, 0, 1, 0 ], 
    [ 0, 1, 1, 2, 0, 1, 1, 0 ], [ 2, 1, 1, 0, 0, 1, 1, 0 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{NrAllRefinedSums}}
\logpage{[ 2, 3, 7 ]}\nobreak
\hyperdef{L}{X7D55D770828A6158}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{NrAllRefinedSums({\mdseries\slshape G, N1, N2, difsums})\index{NrAllRefinedSums@\texttt{NrAllRefinedSums}}
\label{NrAllRefinedSums}
}\hfill{\scriptsize (function)}}\\


 Returns the number of preimages that will need to be checked during a call to \texttt{AllRefinedDifferenceSums} (\ref{AllRefinedDifferenceSums}) with the same arguments. This can give a rough estimate of how long the call
will take to complete. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N1 := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@N2 := NormalSubgroups(G)[8];;|
  !gapprompt@gap>| !gapinput@NrAllRefinedSums(G, N1, N2, [[3,1,1,1], [2,2,2,0]]);|
  22
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{SomeRefinedDifferenceSums}}
\logpage{[ 2, 3, 8 ]}\nobreak
\hyperdef{L}{X866272667D6032BA}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{SomeRefinedDifferenceSums({\mdseries\slshape G, N1, N2, difsums})\index{SomeRefinedDifferenceSums@\texttt{SomeRefinedDifferenceSums}}
\label{SomeRefinedDifferenceSums}
}\hfill{\scriptsize (function)}}\\


 Returns a list of some difference sums in group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N2}} that are preimages of difference sums contained in the list \mbox{\texttt{\mdseries\slshape difsums}} of difference sums in group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N1}}. At least one member of each equivalence class that would appear in the set
of all preimages will be returned, but all preimage difference sums may not
appear. The subgroup \mbox{\texttt{\mdseries\slshape N2}} must be contained in \mbox{\texttt{\mdseries\slshape N1}} and difference sums in \mbox{\texttt{\mdseries\slshape difsums}} are all assumed to be the same size. Current implementation forces a choice of
nonzero identity coefficient when possible. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N1 := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@N2 := NormalSubgroups(G)[8];;|
  !gapprompt@gap>| !gapinput@SomeRefinedDifferenceSums(G, N1, N2, [[3,1,1,1], [2,2,2,0]]);|
  [ [ 1, 1, 0, 1, 0, 1, 2, 0 ], [ 1, 1, 2, 1, 0, 1, 0, 0 ], 
    [ 1, 0, 1, 1, 0, 2, 1, 0 ], [ 1, 2, 1, 1, 0, 0, 1, 0 ], 
    [ 2, 1, 1, 0, 0, 1, 1, 0 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{NrSomeRefinedSums}}
\logpage{[ 2, 3, 9 ]}\nobreak
\hyperdef{L}{X82A9A80085A9F514}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{NrSomeRefinedSums({\mdseries\slshape G, N1, N2, difsums})\index{NrSomeRefinedSums@\texttt{NrSomeRefinedSums}}
\label{NrSomeRefinedSums}
}\hfill{\scriptsize (function)}}\\


 Returns the number of preimages that will need to be checked during a call to \texttt{SomeRefinedDifferenceSums} (\ref{SomeRefinedDifferenceSums}) with the same arguments. This can give a rough estimate of how long the call
will take to complete. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 5);;|
  !gapprompt@gap>| !gapinput@N1 := NormalSubgroups(G)[5];;|
  !gapprompt@gap>| !gapinput@N2 := NormalSubgroups(G)[8];;|
  !gapprompt@gap>| !gapinput@NrSomeRefinedSums(G, N1, N2, [[3,1,1,1], [2,2,2,0]]);|
  21
\end{Verbatim}
 }

 }

 
\section{\textcolor{Chapter }{Equivalence}}\logpage{[ 2, 4, 0 ]}
\hyperdef{L}{X7DD5BE4E84C95B38}{}
{
  Since we are searching for all difference sets or sums up to equivalence, at
each stage we remove excess equivalent sums or sets from our collection. This
can be done with \texttt{EquivalentFreeListOfDifferenceSets} (\ref{EquivalentFreeListOfDifferenceSets}) and \texttt{EquivalentFreeListOfDifferenceSums} (\ref{EquivalentFreeListOfDifferenceSums}). The additional functions \texttt{TranslateFreeListOfDifferenceSets} (\ref{TranslateFreeListOfDifferenceSets}) and \texttt{TranslateFreeListOfDifferenceSums} (\ref{TranslateFreeListOfDifferenceSums}) can be used to eliminate translate equivalent sums or sets, but they are not
used in the main algorithm. Alternatively, \texttt{SmallestEquivalentDifferenceSet} (\ref{SmallestEquivalentDifferenceSet}) uses the \texttt{SmallestImageSet} function from the \textsf{GRAPE} package to produce the lexicographically minimal difference set equivalent to
a given set. Eliminating equivalent sets can then be done by mapping each set
to its minimal representative and then simply eliminating duplicates. This is
done automatically by \texttt{SmallestEquivalentFreeListOfDifferenceSets} (\ref{SmallestEquivalentFreeListOfDifferenceSets}), which is used in the last stage of the main algorithm instead of \texttt{EquivalentFreeListOfDifferenceSets} (\ref{EquivalentFreeListOfDifferenceSets}). While the full algorithm with \texttt{SmallestEquivalentFreeListOfDifferenceSets} (\ref{SmallestEquivalentFreeListOfDifferenceSets}) is roughly 20\% slower on average (and is almost 4x as slow on a few groups of
order 64), this function is used since it is much faster on large automorphism
groups (such as the automorphism group of \texttt{SmallGroup(64, 267)}, which is impossible with \texttt{EquivalentFreeListOfDifferenceSets} (\ref{EquivalentFreeListOfDifferenceSets})) and provides a unique minimal result at the end of the algorithm. 

\subsection{\textcolor{Chapter }{EquivalentFreeListOfDifferenceSets}}
\logpage{[ 2, 4, 1 ]}\nobreak
\hyperdef{L}{X7E4BCB8482E4AE34}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{EquivalentFreeListOfDifferenceSets({\mdseries\slshape G, difsets})\index{EquivalentFreeListOfDifferenceSets@\texttt{EquivalentFreeListOfDifferenceSets}}
\label{EquivalentFreeListOfDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns a list of inequivalent difference sets in the group \mbox{\texttt{\mdseries\slshape G}} that consists of one representative from each equivalence class found in the
list \mbox{\texttt{\mdseries\slshape difsets}} of arbitrary difference sets in \mbox{\texttt{\mdseries\slshape G}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@sets := [[8,9,12,13,14,15], [7,8,9,13,15,16], [1,7,10,11,14,15]];;|
  !gapprompt@gap>| !gapinput@EquivalentFreeListOfDifferenceSets(G, sets);|
  [ [ 8, 9, 12, 13, 14, 15 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{TranslateFreeListOfDifferenceSets}}
\logpage{[ 2, 4, 2 ]}\nobreak
\hyperdef{L}{X8380F5D37E2D411B}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{TranslateFreeListOfDifferenceSets({\mdseries\slshape G, difsets})\index{TranslateFreeListOfDifferenceSets@\texttt{TranslateFreeListOfDifferenceSets}}
\label{TranslateFreeListOfDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns a list of translationally inequivalent difference sets in the group \mbox{\texttt{\mdseries\slshape G}} that consists of one representative from each translational equivalence class
found in the list \mbox{\texttt{\mdseries\slshape difsets}} of arbitrary difference sets in \mbox{\texttt{\mdseries\slshape G}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@sets := [[8,9,12,13,14,15], [7,8,9,13,15,16], [1,7,10,11,14,15]];;|
  !gapprompt@gap>| !gapinput@TranslateFreeListOfDifferenceSets(G, sets);|
  [ [ 8, 9, 12, 13, 14, 15 ], [ 7, 8, 9, 13, 15, 16 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{EquivalentFreeListOfDifferenceSums}}
\logpage{[ 2, 4, 3 ]}\nobreak
\hyperdef{L}{X8639AB227B0CF9F3}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{EquivalentFreeListOfDifferenceSums({\mdseries\slshape G, N, difsums})\index{EquivalentFreeListOfDifferenceSums@\texttt{EquivalentFreeListOfDifferenceSums}}
\label{EquivalentFreeListOfDifferenceSums}
}\hfill{\scriptsize (function)}}\\


 Returns a list of inequivalent difference sums in the group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}} that consists of one representative from each equivalence class found in the
list \mbox{\texttt{\mdseries\slshape difsums}} of arbitrary difference sums in \mbox{\texttt{\mdseries\slshape G}} mod \mbox{\texttt{\mdseries\slshape N}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[3];;|
  !gapprompt@gap>| !gapinput@EquivalentFreeListOfDifferenceSums(G, N, [[4,2], [2,4]]);|
  [ [ 4, 2 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{TranslateFreeListOfDifferenceSums}}
\logpage{[ 2, 4, 4 ]}\nobreak
\hyperdef{L}{X7BF295758033DC3B}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{TranslateFreeListOfDifferenceSums({\mdseries\slshape G, N, difsums})\index{TranslateFreeListOfDifferenceSums@\texttt{TranslateFreeListOfDifferenceSums}}
\label{TranslateFreeListOfDifferenceSums}
}\hfill{\scriptsize (function)}}\\


 Returns a list of translationally inequivalent difference sums in the group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}} that consists of one representative from each translational equivalence class
found in the list \mbox{\texttt{\mdseries\slshape difsums}} of arbitrary difference sums in \mbox{\texttt{\mdseries\slshape G}} mod \mbox{\texttt{\mdseries\slshape N}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[3];;|
  !gapprompt@gap>| !gapinput@TranslateFreeListOfDifferenceSums(G, N, [[4,2], [2,4]]);|
  [ [ 4, 2 ] ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{SmallestEquivalentDifferenceSet}}
\logpage{[ 2, 4, 5 ]}\nobreak
\hyperdef{L}{X857A641A7C86EFA3}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{SmallestEquivalentDifferenceSet({\mdseries\slshape G, D})\index{SmallestEquivalentDifferenceSet@\texttt{SmallestEquivalentDifferenceSet}}
\label{SmallestEquivalentDifferenceSet}
}\hfill{\scriptsize (function)}}\\


 Returns the set that is lexicographically smallest among all sets that are
equivalent to the difference set \mbox{\texttt{\mdseries\slshape D}} in the group \mbox{\texttt{\mdseries\slshape G}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@SmallestEquivalentDifferenceSet(G, [8,9,12,13,14,15]);|
  [ 1, 2, 3, 4, 8, 15 ]
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{SmallestEquivalentFreeListOfDifferenceSets}}
\logpage{[ 2, 4, 6 ]}\nobreak
\hyperdef{L}{X8741BBF4811F942A}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{SmallestEquivalentFreeListOfDifferenceSets({\mdseries\slshape G, difsets})\index{SmallestEquivalentFreeListOfDifferenceSets@\texttt{Smallest}\-\texttt{Equivalent}\-\texttt{Free}\-\texttt{List}\-\texttt{Of}\-\texttt{Difference}\-\texttt{Sets}}
\label{SmallestEquivalentFreeListOfDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns a list containing the lexicographically smallest set for each set in
the list of difference sets \mbox{\texttt{\mdseries\slshape difsets}} in the group \mbox{\texttt{\mdseries\slshape G}}. Duplicates are removed, so the returned list contains exactly one
representative from each equivalence class found in \mbox{\texttt{\mdseries\slshape difsets}}. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@sets := [[8,9,12,13,14,15], [7,8,9,13,15,16], [1,7,10,11,14,15]];;|
  !gapprompt@gap>| !gapinput@SmallestEquivalentFreeListOfDifferenceSets(G, sets);|
  [ [ 1, 2, 3, 4, 8, 15 ] ]
\end{Verbatim}
 }

 }

 
\section{\textcolor{Chapter }{Testing}}\logpage{[ 2, 5, 0 ]}
\hyperdef{L}{X7DE7E7187BE24368}{}
{
  These additional functions are provided to check work and perform other
experimentation. They are inefficient when used repeatedly. For example, when
testing a large number of difference sets in a single group, it is better to
precompute the needed group operations and store them in a table for lookup,
but \texttt{IsDifferenceSet} (\ref{IsDifferenceSet}) simply does the multiplication directly since it is only testing one set. 

\subsection{\textcolor{Chapter }{IsDifferenceSet}}
\logpage{[ 2, 5, 1 ]}\nobreak
\hyperdef{L}{X8545AC1D7D42A84A}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{IsDifferenceSet({\mdseries\slshape G, D})\index{IsDifferenceSet@\texttt{IsDifferenceSet}}
\label{IsDifferenceSet}
}\hfill{\scriptsize (function)}}\\


 Returns true if the set \mbox{\texttt{\mdseries\slshape D}} is a difference set in the group \mbox{\texttt{\mdseries\slshape G}}, and false otherwise. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@IsDifferenceSet(G, [1, 2, 3, 4, 5, 6]);|
  false
  !gapprompt@gap>| !gapinput@IsDifferenceSet(G, [1, 2, 8, 10, 11, 15]);|
  true
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{IsDifferenceSum}}
\logpage{[ 2, 5, 2 ]}\nobreak
\hyperdef{L}{X87AF37B47808830E}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{IsDifferenceSum({\mdseries\slshape G, N, S})\index{IsDifferenceSum@\texttt{IsDifferenceSum}}
\label{IsDifferenceSum}
}\hfill{\scriptsize (function)}}\\


 Returns true if the sum \mbox{\texttt{\mdseries\slshape S}} is a difference sum in the group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}}, and false otherwise. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[3];;|
  !gapprompt@gap>| !gapinput@IsDifferenceSum(G, N, [2, 4]);|
  true
  !gapprompt@gap>| !gapinput@IsDifferenceSum(G, N, [1, 1]);|
  false
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{IsEquivalentDifferenceSet}}
\logpage{[ 2, 5, 3 ]}\nobreak
\hyperdef{L}{X7AE5A8607ADD2F1C}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{IsEquivalentDifferenceSet({\mdseries\slshape G, D1, D2})\index{IsEquivalentDifferenceSet@\texttt{IsEquivalentDifferenceSet}}
\label{IsEquivalentDifferenceSet}
}\hfill{\scriptsize (function)}}\\


 Returns true if sets \mbox{\texttt{\mdseries\slshape D1}} and \mbox{\texttt{\mdseries\slshape D2}} are equivalent in the group \mbox{\texttt{\mdseries\slshape G}}, and false otherwise. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@IsEquivalentDifferenceSet(G, [1,5,8,9,10,14], [1,5,7,8,10,15]);|
  false
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{IsEquivalentDifferenceSum}}
\logpage{[ 2, 5, 4 ]}\nobreak
\hyperdef{L}{X780F33C98032EAA2}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{IsEquivalentDifferenceSum({\mdseries\slshape G, N, S1, S2})\index{IsEquivalentDifferenceSum@\texttt{IsEquivalentDifferenceSum}}
\label{IsEquivalentDifferenceSum}
}\hfill{\scriptsize (function)}}\\


 Returns true if sums \mbox{\texttt{\mdseries\slshape S1}} and \mbox{\texttt{\mdseries\slshape S2}} are equivalent in the group \mbox{\texttt{\mdseries\slshape G}} mod its normal subgroup \mbox{\texttt{\mdseries\slshape N}}, and false otherwise. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@G := SmallGroup(16, 4);;|
  !gapprompt@gap>| !gapinput@N := NormalSubgroups(G)[3];;|
  !gapprompt@gap>| !gapinput@IsEquivalentDifferenceSum(G, N, [2,4], [4,2]);|
  true
\end{Verbatim}
 }

 }

 
\section{\textcolor{Chapter }{Loading Results}}\logpage{[ 2, 6, 0 ]}
\hyperdef{L}{X83340C888396D9BF}{}
{
  The \texttt{data} directory of the \textsf{DifSets} Package contains precomputed results for 1006 of the 1032 groups of order less
than 100. The following two functions are the easiest way to access these
precomputed lists of difference sets up to equivalence. 

\subsection{\textcolor{Chapter }{CanLoadDifferenceSets}}
\logpage{[ 2, 6, 1 ]}\nobreak
\hyperdef{L}{X7B41B3107A96949D}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{CanLoadDifferenceSets({\mdseries\slshape v, n})\index{CanLoadDifferenceSets@\texttt{CanLoadDifferenceSets}}
\label{CanLoadDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns true if a precomputed list of all difference sets up to equivalence
can be loaded from the package library for the group \texttt{SmallGroup(\mbox{\texttt{\mdseries\slshape v}}, \mbox{\texttt{\mdseries\slshape n}})}, and false otherwise. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@CanLoadDifferenceSets(36, 9);|
  true
  !gapprompt@gap>| !gapinput@CanLoadDifferenceSets(79, 1);|
  false
\end{Verbatim}
 }

 

\subsection{\textcolor{Chapter }{LoadDifferenceSets}}
\logpage{[ 2, 6, 2 ]}\nobreak
\hyperdef{L}{X848925877C3C891F}{}
{\noindent\textcolor{FuncColor}{$\triangleright$\enspace\texttt{LoadDifferenceSets({\mdseries\slshape v, n})\index{LoadDifferenceSets@\texttt{LoadDifferenceSets}}
\label{LoadDifferenceSets}
}\hfill{\scriptsize (function)}}\\


 Returns the precomputed list of all difference sets up to equivalence for the
group \texttt{SmallGroup(\mbox{\texttt{\mdseries\slshape v}}, \mbox{\texttt{\mdseries\slshape n}})} stored in the package library. An error is thrown if no precomputed list is
available. Note that the listed difference sets are specific to \texttt{SmallGroup(\mbox{\texttt{\mdseries\slshape v}}, \mbox{\texttt{\mdseries\slshape n}})}, as \textsf{GAP} may label entries of other isomorphic versions of the same group differently. 
\begin{Verbatim}[commandchars=!@|,fontsize=\small,frame=single,label=Example]
  !gapprompt@gap>| !gapinput@LoadDifferenceSets(15, 1);|
  [ [ 1, 2, 3, 4, 8, 11, 12 ] ]
  !gapprompt@gap>| !gapinput@G := SmallGroup(15, 1);; H := AbelianGroup([15]);;|
  !gapprompt@gap>| !gapinput@IdGroup(G) = IdGroup(H);|
  true
  !gapprompt@gap>| !gapinput@IsDifferenceSet(G, [1, 2, 3, 4, 8, 11, 12]);|
  true
  !gapprompt@gap>| !gapinput@IsDifferenceSet(H, [1, 2, 3, 4, 8, 11, 12]);|
  false
\end{Verbatim}
 }

 }

 }

 
\chapter{\textcolor{Chapter }{Results}}\logpage{[ 3, 0, 0 ]}
\hyperdef{L}{X7A92ECF9816C7E28}{}
{
  The \textsf{DifSets} Package was designed with the goal of finding all difference sets up to
equivalence in groups of order 64 and 96, a goal which was accomplished.
Overall, the algorithm has successfully computed results for 1006 of the 1032
groups of order less than 100. Full results, which include timings, number of
sets, and the sets themselves can be found in the \texttt{data} subdirectory of the package, which is organized by group order and contains a
single \texttt{.txt} file for each computed group. A list of all timings can also be found in the
file \texttt{groups.csv} in the \texttt{data} directory, and the difference sets themselves can be loaded using the function \texttt{LoadDifferenceSets} (\ref{LoadDifferenceSets}). All computations were performed using \textsf{GAP} 4.9.1 on a 4.00GHz i7-6700K using 8GB of RAM. Here we give a basic overview of
results and comments on timings. Throughout this chapter we will refer to the
group returned by the \textsf{GAP} function \texttt{SmallGroup(v, n)} as \texttt{[v, n]}. 
\section{\textcolor{Chapter }{Order 16 and 36}}\logpage{[ 3, 1, 0 ]}
\hyperdef{L}{X85CC7A44864637B3}{}
{
  Difference sets in groups of order 16 and 36 form the first nontrivial
examples of the Hadamard parameters, and exhaustive enumerations are already
well known. Still, computation of these sets gives a useful benchmark and
check of accuracy. 

 Almost all groups in these orders take less than a second. The group \texttt{[36, 9]}, however, takes several orders of magnitude longer than other groups of order
36. This is because \texttt{[36, 9]} does not have small normal subgroups (in particular, its smallest nontrivial
normal subgroup has order 9), and refining across a large gap in sizes,
expecially near the end of the algorithm, requires checking significantly more
preimages. 

 \begin{center}
\begin{tabular}{ccc}Group&
Difference Sets&
Time (seconds)\\
\hline
\texttt{[16, 1]}&
0&
0.030\\
\texttt{[16, 2]}&
3&
0.103\\
\texttt{[16, 3]}&
4&
0.100\\
\texttt{[16, 4]}&
3&
0.100\\
\texttt{[16, 5]}&
2&
0.061\\
\texttt{[16, 6]}&
2&
0.071\\
\texttt{[16, 7]}&
0&
0.072\\
\texttt{[16, 8]}&
2&
0.070\\
\texttt{[16, 9]}&
2&
0.082\\
\texttt{[16, 10]}&
2&
0.187\\
\texttt{[16, 11]}&
2&
0.121\\
\texttt{[16, 12]}&
2&
0.195\\
\texttt{[16, 13]}&
2&
0.117\\
\texttt{[16, 14]}&
1&
0.059\\
\end{tabular}\\[2mm]
\end{center}

 \begin{center}
\begin{tabular}{ccc}Group&
Difference Sets&
Time (seconds)\\
\hline
\texttt{[36, 1]}&
0&
0.335\\
\texttt{[36, 2]}&
0&
0.201\\
\texttt{[36, 3]}&
0&
0.407\\
\texttt{[36, 4]}&
0&
0.322\\
\texttt{[36, 5]}&
0&
0.218\\
\texttt{[36, 6]}&
6&
0.412\\
\texttt{[36, 7]}&
1&
0.795\\
\texttt{[36, 8]}&
4&
0.340\\
\texttt{[36, 9]}&
5&
340.989\\
\texttt{[36, 10]}&
6&
1.137\\
\texttt{[36, 11]}&
3&
0.699\\
\texttt{[36, 12]}&
6&
0.417\\
\texttt{[36, 13]}&
1&
0.801\\
\texttt{[36, 14]}&
3&
0.434\\
\end{tabular}\\[2mm]
\end{center}

 }

 
\section{\textcolor{Chapter }{Order 64 and 96}}\logpage{[ 3, 2, 0 ]}
\hyperdef{L}{X7806C267831D6985}{}
{
  Difference sets in groups of order 64 also satisfy the Hadamard parameters,
while difference sets in groups of order 96 satisfy the McFarland parameters.
Since there are many groups of both orders, here we just give some examples
and summaries. In particular, the tables below list the fastest, slowest, and
median five groups of each order, sorted by time. 

 Groups of order 64 are $p$-groups, and thus always have enough normal subgroups to form long refining
series. This means the refining steps are relatively efficient for all groups
in this order. The main difference between groups is the size of the
automorphism group, and, in particular, four of the five groups taking the
largest amount of time are four of the five groups with the largest
automorphism groups in this order. The additional group in the top five, \texttt{[64, 235]}, has a relatively large number of difference sets, but is otherwise
unremarkable. In general, smaller numbers of difference sets correspond to
faster times, and in fact the eight groups with no difference sets were
computed the fastest, beating the next fastest groups by an order of
magnitude. Overall, the mean computation time for a group of order 64 was
3988.476 seconds, with a median time of 1493.175 seconds. This means that the
total computer time to compute all difference sets in groups of order 64 was
roughly 12 days. 

 In groups of order 96 we do not always have large numbers of normal subgroups,
and, as with \texttt{[36, 9]}, this can substantially slow down computation. In fact, the five groups
taking the longest computation time are five of the six groups with fewest
normal subgroups in this order. We are helped, however, by the fact that the
only valid choice of $k$ is 20, which is relatively small and thus does not lead to large numbers of
preimages even across large gaps in the refining series. Many groups in this
order have no difference sets, but even for these groups computation can be
slow. While the fastest groups contain no difference sets, many groups with no
difference sets actually take much longer than other groups that do contain
difference sets. Overall, the mean computation time for a group of order 96
was 24447.991 seconds, with a median time of 11278.765 seconds. This means
that the total computer time to compute all difference sets in groups of order
96 was roughly 65 days. 

 \begin{center}
\begin{tabular}{ccc}Group&
Difference Sets&
Time (seconds)\\
\hline
\texttt{[64, 52]}&
0&
3.451\\
\texttt{[64, 54]}&
0&
3.463\\
\texttt{[64, 47]}&
0&
3.594\\
\texttt{[64, 186]}&
0&
3.940\\
\texttt{[64, 1]}&
0&
3.950\\
\texttt{[64, 166]}&
2312&
1424.692\\
\texttt{[64, 134]}&
342&
1439.484\\
\texttt{[64, 135]}&
540&
1493.175\\
\texttt{[64, 7]}&
1320&
1515.710\\
\texttt{[64, 160]}&
3192&
1518.693\\
\texttt{[64, 192]}&
222&
21131.394\\
\texttt{[64, 267]}&
4&
23662.500\\
\texttt{[64, 235]}&
4317&
24566.186\\
\texttt{[64, 260]}&
30&
144338.020\\
\texttt{[64, 262]}&
148&
229488.988\\
\end{tabular}\\[2mm]
\end{center}

 \begin{center}
\begin{tabular}{ccc}Group&
Difference Sets&
Time (seconds)\\
\hline
\texttt{[96, 2]}&
0&
8.731\\
\texttt{[96, 59]}&
0&
8.791\\
\texttt{[96, 189]}&
0&
29.378\\
\texttt{[96, 66]}&
0&
29.777\\
\texttt{[96, 46]}&
0&
44.478\\
\texttt{[96, 209]}&
4&
10809.673\\
\texttt{[96, 133]}&
16&
11198.052\\
\texttt{[96, 224]}&
0&
11278.765\\
\texttt{[96, 89]}&
0&
11349.466\\
\texttt{[96, 102]}&
0&
11415.688\\
\texttt{[96, 227]}&
42&
308246.830\\
\texttt{[96, 64]}&
14&
310447.407\\
\texttt{[96, 70]}&
28&
514559.313\\
\texttt{[96, 72]}&
2&
515196.547\\
\texttt{[96, 71]}&
8&
871439.024\\
\end{tabular}\\[2mm]
\end{center}

 }

 
\section{\textcolor{Chapter }{Comments}}\logpage{[ 3, 3, 0 ]}
\hyperdef{L}{X780C79EB85C32138}{}
{
  Overall, the algorithm spends almost all of its time performing four
operations: refining sums to sums in several stages using \texttt{SomeRefinedDifferenceSums} (\ref{SomeRefinedDifferenceSums}), refining sums to sets in the final stage using \texttt{SomeRefinedDifferenceSets} (\ref{SomeRefinedDifferenceSets}), removing equivalent difference sums in several stages using \texttt{EquivalentFreeListOfDifferenceSums} (\ref{EquivalentFreeListOfDifferenceSums}), and removing equivalent difference sets in the final stage using \texttt{SmallestEquivalentFreeListOfDifferenceSets} (\ref{SmallestEquivalentFreeListOfDifferenceSets}). On typical groups of order 16 and order 36 (i.e., not \texttt{[36, 9]}), each of these four operations takes roughly the same time. On groups of
order 64, some testing indicates that one or two orders of magnitude more time
are spent in the final stage, when the algorithm uses \texttt{SomeRefinedDifferenceSets} (\ref{SomeRefinedDifferenceSets}) and \texttt{SmallestEquivalentFreeListOfDifferenceSets} (\ref{SmallestEquivalentFreeListOfDifferenceSets}). This discrepency is likely to remain or increase for larger order groups, as
the number of preimages to check increases exponentially with the number of
cosets. For the tested groups of order 64, roughly 60\% of the time in the
final stage was spent refining, with the remaining 40\% spent removing
equivalent sets. 

 Large automorphism groups make removing equivalents time-consuming and large
jumps in the size of the normal subgroups used, especially near the end of the
algorithm, make refining difficult. So, in general, the algorithm seems to
work well when the group has a small automorphism group and many (small)
normal subgroups. In addition, the algorithm does better when the values of $k$ that need to be checked are small, as this limits both the number of preimages
to check as well as the amount of time required for checking sets and
equivalences. It is also generally faster when the final result is a smaller
number of difference sets. 

 There are twenty-six groups of order less than 100 in which the algorithm was
not able to complete a search. Fourteen of these groups are prime order
cyclic. As simple groups, these groups have no normal subgroups and thus no
possibility for refining, which means the algorithm must search every possible
subset of size $k$ to find all difference sets of size $k$. Even for groups of relatively small order, such as order 31, this is
infeasible, and with current implementation will overflow memory before even
starting the search (one of these groups, \texttt{[37, 1]} is actually feasible to search without this implementation issue, but the
others have too many sets to check). The remaining groups have either too few
normal subgroups, large jumps in the refining series, large possible values of $k$, or a combination of these problems. 

 The next natural cases for exhaustive search are groups of order 100 and order
144, which give the next Hadamard parameters. Unfortunately, preliminary
testing indicates that this algorithm is not likely to be able to compute all
difference sets for these groups. For example, a typical difference sum in \texttt{[100, 9]} is \texttt{[5, 4, 3, 3, 0, 3, 2, 3, 2, 2, 2, 2, 2, 1, 2, 1, 1, 2, 2, 3]}, which has roughly $6 \times 10^{16}$ preimage sets to check. In the search for difference sets in \texttt{[36, 9]} the single difference sum \texttt{[6, 3, 3, 3]}, with around $3 \times 10^7$ preimages, takes around 300 seconds to search. Thus even if we could check
sets in \texttt{[100, 9]} as fast as in \texttt{[36, 9]}, the search would take roughly 20000 years. Some testing suggests that coding
pieces of the algorithm in C could give one or two orders of magnitude of
speedup, but even further speedup is required to make the search feasible, so
some other improvements, either in theory or implementation, are needed as
well. }

 }

 \newpage
\immediate\write\pagenrlog{["End"], \arabic{page}];}
\immediate\closeout\pagenrlog
\end{document}
